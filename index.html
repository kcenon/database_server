<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Database Server: Database Server</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Database Server<span id="projectnumber">&#160;0.1.0</span>
   </div>
   <div id="projectbrief">Database Gateway Middleware Server</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Database Server </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> </p><blockquote class="doxtable">
<p>&zwj;ğŸ‡°ğŸ‡· í•œêµ­ì–´ ë²„ì „ </p>
</blockquote>
<h1><a class="anchor" id="autotoc_md19"></a>
Database Server</h1>
<p>A high-performance database gateway middleware server that provides connection pooling, query routing, and caching capabilities.</p>
<h2><a class="anchor" id="autotoc_md20"></a>
Overview</h2>
<p>The Database Server is part of the kcenon unified system architecture evolution from a monolithic library to a gateway middleware architecture. It sits between client applications and physical databases, providing:</p>
<ul>
<li><b>Connection Pooling</b>: Efficient connection management with priority-based scheduling</li>
<li><b>Query Routing</b>: Load balancing across multiple database connections</li>
<li><b>Health Monitoring</b>: Automatic detection and recovery of failed connections</li>
<li><b>Query Caching</b> (Optional): Result caching for frequently executed queries</li>
</ul>
<h2><a class="anchor" id="autotoc_md21"></a>
Architecture</h2>
<div class="fragment"><div class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</div>
<div class="line">â”‚                database_server                   â”‚</div>
<div class="line">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</div>
<div class="line">â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚</div>
<div class="line">â”‚  â”‚   Listener   â”‚â”€â”€â”€â–¶â”‚  Auth Middleware    â”‚    â”‚</div>
<div class="line">â”‚  â”‚    (TCP)    â”‚    â”‚  (Rate Limiting)    â”‚    â”‚</div>
<div class="line">â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚</div>
<div class="line">â”‚                               â”‚                 â”‚</div>
<div class="line">â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚</div>
<div class="line">â”‚                    â”‚   Request Handler   â”‚     â”‚</div>
<div class="line">â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚</div>
<div class="line">â”‚                               â”‚                 â”‚</div>
<div class="line">â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚</div>
<div class="line">â”‚                    â”‚   Query Router      â”‚     â”‚</div>
<div class="line">â”‚                    â”‚   (Load Balancer)   â”‚     â”‚</div>
<div class="line">â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚</div>
<div class="line">â”‚                               â”‚                 â”‚</div>
<div class="line">â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚</div>
<div class="line">â”‚  â”‚ Query Cache â”‚â—€â”€â”€â–¶â”‚ Connection Pool â”‚       â”‚</div>
<div class="line">â”‚  â”‚  (Optional) â”‚    â”‚                 â”‚       â”‚</div>
<div class="line">â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚</div>
<div class="line">â”‚                               â”‚                 â”‚</div>
<div class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>
<div class="line">                                â”‚</div>
<div class="line">                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</div>
<div class="line">                    â”‚   Physical Database    â”‚</div>
<div class="line">                    â”‚ (PostgreSQL, MySQL...) â”‚</div>
<div class="line">                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md22"></a>
Dependencies</h2>
<h3><a class="anchor" id="autotoc_md23"></a>
Required</h3>
<ul>
<li><b>common_system</b> (Tier 0) - Core utilities, Result&lt;T&gt;, logging interfaces</li>
<li><b>thread_system</b> (Tier 1) - Job scheduling, thread pool management</li>
<li><b>database_system</b> (Tier 2) - Database interfaces and types</li>
<li><b>network_system</b> (Tier 4) - TCP server implementation</li>
<li><b>container_system</b> (Tier 1) - Protocol serialization (required for query protocol messages)</li>
</ul>
<h3><a class="anchor" id="autotoc_md24"></a>
Optional</h3>
<ul>
<li><b>monitoring_system</b> (Tier 3) - Performance metrics and health monitoring</li>
</ul>
<h2><a class="anchor" id="autotoc_md25"></a>
Building</h2>
<h3><a class="anchor" id="autotoc_md26"></a>
Prerequisites</h3>
<ul>
<li>CMake 3.16 or higher</li>
<li>C++20 compatible compiler (GCC 10+, Clang 12+, MSVC 2019+)</li>
<li>Required system dependencies built and available</li>
</ul>
<h3><a class="anchor" id="autotoc_md27"></a>
Build Steps</h3>
<div class="fragment"><div class="line"># Create build directory</div>
<div class="line">mkdir build &amp;&amp; cd build</div>
<div class="line"> </div>
<div class="line"># Configure</div>
<div class="line">cmake ..</div>
<div class="line"> </div>
<div class="line"># Build</div>
<div class="line">cmake --build .</div>
<div class="line"> </div>
<div class="line"># Run (optional)</div>
<div class="line">./bin/database_server --help</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md28"></a>
CMake Options</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Option   </th><th class="markdownTableHeadNone">Default   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>BUILD_TESTS</code>   </td><td class="markdownTableBodyNone">ON   </td><td class="markdownTableBodyNone">Build unit tests    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>BUILD_BENCHMARKS</code>   </td><td class="markdownTableBodyNone">OFF   </td><td class="markdownTableBodyNone">Build performance benchmarks    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>BUILD_SAMPLES</code>   </td><td class="markdownTableBodyNone">OFF   </td><td class="markdownTableBodyNone">Build sample applications    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>BUILD_MODULES</code>   </td><td class="markdownTableBodyNone">OFF   </td><td class="markdownTableBodyNone">Build C++20 module library    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>BUILD_WITH_MONITORING_SYSTEM</code>   </td><td class="markdownTableBodyNone">OFF   </td><td class="markdownTableBodyNone">Enable monitoring integration    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>BUILD_WITH_CONTAINER_SYSTEM</code>   </td><td class="markdownTableBodyNone">ON   </td><td class="markdownTableBodyNone">Protocol serialization (required, build fails without it)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>ENABLE_COVERAGE</code>   </td><td class="markdownTableBodyNone">OFF   </td><td class="markdownTableBodyNone">Enable code coverage   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md29"></a>
Integration Macros</h3>
<p>Source code uses unified <code>KCENON_WITH_*=1</code> macros for integration gating, ensuring consistency across all kcenon ecosystem projects:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Macro   </th><th class="markdownTableHeadNone">CMake Option   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>KCENON_WITH_CONTAINER_SYSTEM=1</code>   </td><td class="markdownTableBodyNone"><code>BUILD_WITH_CONTAINER_SYSTEM</code>   </td><td class="markdownTableBodyNone">Container serialization support    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>KCENON_WITH_MONITORING_SYSTEM=1</code>   </td><td class="markdownTableBodyNone"><code>BUILD_WITH_MONITORING_SYSTEM</code>   </td><td class="markdownTableBodyNone">Monitoring integration    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>KCENON_WITH_COMMON_SYSTEM=1</code>   </td><td class="markdownTableBodyNone">Auto-detected   </td><td class="markdownTableBodyNone">Common system integration   </td></tr>
</table>
<p>CMake directly defines <code>KCENON_WITH_*=1</code> preprocessor macros when the corresponding <code>BUILD_WITH_*</code> options are enabled. This unified macro system ensures consistent integration gating across all kcenon repositories without intermediate mapping.</p>
<h3><a class="anchor" id="autotoc_md30"></a>
Running Tests</h3>
<div class="fragment"><div class="line"># Build with tests enabled (default)</div>
<div class="line">cmake .. -DBUILD_TESTS=ON</div>
<div class="line">cmake --build .</div>
<div class="line"> </div>
<div class="line"># Run all tests</div>
<div class="line">ctest --output-on-failure</div>
<div class="line"> </div>
<div class="line"># Or run specific test executable directly</div>
<div class="line">./bin/query_protocol_test</div>
<div class="line">./bin/resilience_test</div>
<div class="line">./bin/integration_test</div>
<div class="line">./bin/rate_limiter_test</div>
<div class="line">./bin/auth_middleware_test</div>
<div class="line">./bin/connection_pool_test</div>
<div class="line">./bin/query_cache_test</div>
</div><!-- fragment --><p><b>Current Test Coverage:</b></p><ul>
<li>Query Protocol Tests (45 tests)<ul>
<li>Query types and status code conversions</li>
<li>Message header construction</li>
<li>Auth token validation and expiration</li>
<li>Query param value types</li>
<li>Query request/response serialization</li>
<li>Error handling for invalid inputs</li>
</ul>
</li>
<li>Resilience Tests (29 tests)<ul>
<li>Health status structure and success rate calculation</li>
<li>Health check configuration defaults and customization</li>
<li>Reconnection configuration validation</li>
<li>Connection state enum string conversion</li>
<li>Connection health monitor with null backend handling</li>
<li>Resilient database connection edge cases</li>
</ul>
</li>
<li>Integration Tests (Phase 3.5)<ul>
<li>Auth middleware authentication flow</li>
<li>Rate limiting behavior under load</li>
<li>Query router metrics tracking</li>
<li>Concurrent request handling</li>
<li>Full pipeline throughput tests</li>
<li>Error handling scenarios</li>
</ul>
</li>
<li>Session ID Security Tests<ul>
<li>Format validation (32-character hex string)</li>
<li>Uniqueness verification across 100,000 samples</li>
<li>Entropy estimation (&gt; 3.5 bits per character)</li>
<li>Thread-safety with concurrent generation</li>
<li>Performance validation (&lt; 1Î¼s per generation)</li>
</ul>
</li>
<li>Rate Limiter Tests<ul>
<li>Sliding window algorithm correctness</li>
<li>Burst handling and configuration</li>
<li>Block duration behavior</li>
<li>Concurrent access safety</li>
<li>Client independence verification</li>
</ul>
</li>
<li>Auth Middleware Tests<ul>
<li>Token validation success/failure cases</li>
<li>Token expiration handling</li>
<li>Rate limiting integration</li>
<li>Audit event emission</li>
<li>Metrics collection</li>
<li>Session management</li>
</ul>
</li>
<li>Connection Pool Tests<ul>
<li>Pool configuration and initialization</li>
<li>Connection acquisition and release</li>
<li>Pool exhaustion and timeout handling</li>
<li>Graceful shutdown behavior</li>
<li>Health check functionality</li>
<li>Priority-based metrics tracking</li>
<li>Concurrent access safety</li>
</ul>
</li>
<li>Query Cache Tests (32 tests)<ul>
<li>Cache configuration defaults and customization</li>
<li>Basic cache operations (get, put, clear)</li>
<li>LRU eviction policy verification</li>
<li>TTL-based expiration handling</li>
<li>Table-based cache invalidation</li>
<li>Cache key generation from SQL and parameters</li>
<li>Cache metrics (hits, misses, evictions)</li>
<li>Size limit enforcement</li>
<li>Thread safety with concurrent access</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md31"></a>
C++20 Modules</h3>
<p>The project supports C++20 modules for improved compilation times and better encapsulation.</p>
<p><b>Requirements:</b></p><ul>
<li>Clang 16.0+ or GCC 14.0+ or MSVC 19.29+</li>
<li>CMake 3.28+ recommended for best module support</li>
</ul>
<p><b>Building with Modules:</b></p>
<div class="fragment"><div class="line">cmake .. -DBUILD_MODULES=ON</div>
<div class="line">cmake --build .</div>
</div><!-- fragment --><p><b>Module Structure:</b></p>
<div class="fragment"><div class="line">kcenon.database_server              # Primary module interface</div>
<div class="line">â”œâ”€â”€ :core                           # Server app and configuration</div>
<div class="line">â”œâ”€â”€ :gateway                        # Query protocol and routing</div>
<div class="line">â”œâ”€â”€ :pooling                        # Connection pool management</div>
<div class="line">â”œâ”€â”€ :resilience                     # Health monitoring and recovery</div>
<div class="line">â””â”€â”€ :metrics                        # CRTP-based metrics collection</div>
</div><!-- fragment --><p><b>Usage:</b></p>
<div class="fragment"><div class="line"><span class="keyword">import</span> kcenon.database_server;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>() {</div>
<div class="line">    <a class="code hl_class" href="classdatabase__server_1_1server__app.html">database_server::server_app</a> app;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<span class="keyword">auto</span> result = app.<a class="code hl_function" href="classdatabase__server_1_1server__app.html#a2fe8890d558f5d67f8051709d22b8391">initialize</a>(<span class="stringliteral">&quot;config.yaml&quot;</span>); !result) {</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> app.<a class="code hl_function" href="classdatabase__server_1_1server__app.html#a5c81b07f8c97e8aed37f5725c782f4bf">run</a>();</div>
<div class="line">}</div>
<div class="ttc" id="aclassdatabase__server_1_1server__app_html"><div class="ttname"><a href="classdatabase__server_1_1server__app.html">database_server::server_app</a></div><div class="ttdoc">Main database server application.</div><div class="ttdef"><b>Definition</b> <a href="server__app_8h_source.html#l00116">server_app.h:117</a></div></div>
<div class="ttc" id="aclassdatabase__server_1_1server__app_html_a2fe8890d558f5d67f8051709d22b8391"><div class="ttname"><a href="classdatabase__server_1_1server__app.html#a2fe8890d558f5d67f8051709d22b8391">database_server::server_app::initialize</a></div><div class="ttdeci">kcenon::common::VoidResult initialize(const std::string &amp;config_path)</div><div class="ttdoc">Initialize the server with configuration.</div><div class="ttdef"><b>Definition</b> <a href="server__app_8cpp_source.html#l00063">server_app.cpp:63</a></div></div>
<div class="ttc" id="aclassdatabase__server_1_1server__app_html_a5c81b07f8c97e8aed37f5725c782f4bf"><div class="ttname"><a href="classdatabase__server_1_1server__app.html#a5c81b07f8c97e8aed37f5725c782f4bf">database_server::server_app::run</a></div><div class="ttdeci">int run()</div><div class="ttdoc">Run the server main loop.</div><div class="ttdef"><b>Definition</b> <a href="server__app_8cpp_source.html#l00211">server_app.cpp:211</a></div></div>
<div class="ttc" id="amain_8cpp_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition</b> <a href="main_8cpp_source.html#l00077">main.cpp:77</a></div></div>
</div><!-- fragment --><p><b>Partition Imports:</b></p>
<div class="fragment"><div class="line"><span class="comment">// Import only gateway components</span></div>
<div class="line"><span class="keyword">import</span> kcenon.database_server:gateway;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Use gateway types</span></div>
<div class="line"><a class="code hl_struct" href="structdatabase__server_1_1gateway_1_1query__request.html">database_server::gateway::query_request</a> request(<span class="stringliteral">&quot;SELECT * FROM users&quot;</span>,</div>
<div class="line">                                                  <a class="code hl_enumvalue" href="namespacedatabase__server_1_1gateway.html#a49071571a008ed3afc39c28ed25a3a5ea99938282f04071859941e18f16efcf42">database_server::gateway::query_type::select</a>);</div>
<div class="ttc" id="anamespacedatabase__server_1_1gateway_html_a49071571a008ed3afc39c28ed25a3a5ea99938282f04071859941e18f16efcf42"><div class="ttname"><a href="namespacedatabase__server_1_1gateway.html#a49071571a008ed3afc39c28ed25a3a5ea99938282f04071859941e18f16efcf42">database_server::gateway::query_type::select</a></div><div class="ttdeci">@ select</div><div class="ttdoc">SELECT query - retrieves data.</div></div>
<div class="ttc" id="astructdatabase__server_1_1gateway_1_1query__request_html"><div class="ttname"><a href="structdatabase__server_1_1gateway_1_1query__request.html">database_server::gateway::query_request</a></div><div class="ttdoc">Request message for database queries.</div><div class="ttdef"><b>Definition</b> <a href="query__protocol_8h_source.html#l00179">query_protocol.h:180</a></div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md32"></a>
Running Benchmarks</h3>
<div class="fragment"><div class="line"># Build with benchmarks enabled</div>
<div class="line">cmake .. -DBUILD_BENCHMARKS=ON</div>
<div class="line">cmake --build .</div>
<div class="line"> </div>
<div class="line"># Run benchmarks</div>
<div class="line">./bin/gateway_benchmarks</div>
</div><!-- fragment --><p><b>Performance Benchmarks (Phase 3.5):</b></p><ul>
<li>Router routing overhead measurement (target: &lt; 1ms)</li>
<li>Query throughput benchmarks (target: 10k+ queries/sec)</li>
<li>Auth middleware validation throughput</li>
<li>Rate limiter performance</li>
<li>Serialization/deserialization throughput</li>
<li>Latency distribution (p50, p90, p99)</li>
<li>Concurrent access patterns</li>
</ul>
<h2><a class="anchor" id="autotoc_md33"></a>
Configuration</h2>
<p>The server can be configured using a configuration file (default: <code>config.conf</code>):</p>
<div class="fragment"><div class="line"># Server identification</div>
<div class="line">name=my_database_server</div>
<div class="line"> </div>
<div class="line"># Network settings</div>
<div class="line">network.host=0.0.0.0</div>
<div class="line">network.port=5432</div>
<div class="line">network.enable_tls=false</div>
<div class="line">network.max_connections=100</div>
<div class="line">network.connection_timeout_ms=30000</div>
<div class="line"> </div>
<div class="line"># Logging</div>
<div class="line">logging.level=info</div>
<div class="line">logging.enable_console=true</div>
<div class="line"> </div>
<div class="line"># Connection pool (Phase 2)</div>
<div class="line">pool.min_connections=5</div>
<div class="line">pool.max_connections=50</div>
<div class="line">pool.idle_timeout_ms=60000</div>
<div class="line">pool.health_check_interval_ms=30000</div>
<div class="line"> </div>
<div class="line"># Authentication (Phase 3.4)</div>
<div class="line">auth.enabled=true</div>
<div class="line">auth.validate_on_each_request=false</div>
<div class="line">auth.token_refresh_window_ms=300000</div>
<div class="line"> </div>
<div class="line"># Rate Limiting (Phase 3.4)</div>
<div class="line">rate_limit.enabled=true</div>
<div class="line">rate_limit.requests_per_second=100</div>
<div class="line">rate_limit.burst_size=200</div>
<div class="line">rate_limit.window_size_ms=1000</div>
<div class="line">rate_limit.block_duration_ms=60000</div>
<div class="line"> </div>
<div class="line"># Query Cache (Phase 3)</div>
<div class="line">cache.enabled=true</div>
<div class="line">cache.max_entries=10000</div>
<div class="line">cache.ttl_seconds=300</div>
<div class="line">cache.max_result_size_bytes=1048576</div>
<div class="line">cache.enable_lru=true</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md34"></a>
Usage</h2>
<div class="fragment"><div class="line"># Run with default configuration</div>
<div class="line">./database_server</div>
<div class="line"> </div>
<div class="line"># Run with custom configuration file</div>
<div class="line">./database_server -c /path/to/config.conf</div>
<div class="line"> </div>
<div class="line"># Show help</div>
<div class="line">./database_server --help</div>
<div class="line"> </div>
<div class="line"># Show version</div>
<div class="line">./database_server --version</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md35"></a>
Development Roadmap</h2>
<h3><a class="anchor" id="autotoc_md36"></a>
Phase 1: Scaffolding &amp; Dependency Setup</h3>
<ul>
<li>[x] Create basic directory structure</li>
<li>[x] Configure CMakeLists.txt with dependencies</li>
<li>[x] Implement basic server_app interface</li>
<li>[x] Create <a class="el" href="main_8cpp.html" title="Database server entry point.">main.cpp</a> entry point</li>
<li>[x] Add configuration loading</li>
</ul>
<h3><a class="anchor" id="autotoc_md37"></a>
Phase 2: Core Migration (Completed)</h3>
<ul>
<li>[x] Migrate connection_pool from database_system<ul>
<li>[x] connection_priority enum with 4 priority levels</li>
<li>[x] pool_metrics with priority-specific tracking</li>
<li>[x] connection_pool with adaptive job queue integration</li>
<li>[x] Server-side connection pool types (<code><a class="el" href="connection__types_8h.html" title="Connection pool types for database_server middleware.">connection_types.h</a></code>)<ul>
<li>connection_pool_config, connection_stats, connection_wrapper</li>
<li>connection_pool_base abstract interface</li>
<li>connection_pool implementation</li>
</ul>
</li>
</ul>
</li>
<li>[x] Migrate resilience logic from database_system<ul>
<li>[x] connection_health_monitor with heartbeat-based health tracking</li>
<li>[x] resilient_database_connection with automatic reconnection</li>
</ul>
</li>
<li>[x] Update namespace to <a class="el" href="namespacedatabase__server_1_1pooling.html">database_server::pooling</a> and <a class="el" href="namespacedatabase__server_1_1resilience.html">database_server::resilience</a></li>
<li>[x] Add database_system as required dependency</li>
</ul>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b>: As of database_system Phase 4.3, client-side connection pooling was removed (Client Library Diet initiative). Connection pooling is now handled server-side via <a class="el" href="namespacedatabase__server.html">database_server</a> middleware. Client applications should use ProxyMode (<code>set_mode_proxy()</code>) to connect through <a class="el" href="namespacedatabase__server.html">database_server</a>. </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md38"></a>
Phase 3: Network Gateway Implementation (Current)</h3>
<ul>
<li>[x] Define and implement Query Protocol<ul>
<li>[x] <a class="el" href="query__types_8h.html" title="Query protocol type definitions for database gateway.">query_types.h</a>: Query type and status code enums</li>
<li>[x] <a class="el" href="query__protocol_8h.html" title="Query protocol message structures for database gateway.">query_protocol.h</a>: Request/response message structures</li>
<li>[x] Serialization using container_system</li>
<li>[x] Unit tests for message validation (45 tests)</li>
<li>[x] Refactored into modular structure (see <a href="https://github.com/kcenon/database_server/issues/32">#32</a>):<ul>
<li><code><a class="el" href="serialization__helpers_8h.html" title="Common serialization utilities for query protocol.">protocol/serialization_helpers.h</a></code>: Common utilities</li>
<li><code><a class="el" href="header__serializer_8cpp.html" title="Implementation of message_header serialization.">protocol/header_serializer.cpp</a></code>: message_header</li>
<li><code><a class="el" href="auth__serializer_8cpp.html" title="Implementation of auth_token serialization.">protocol/auth_serializer.cpp</a></code>: auth_token</li>
<li><code><a class="el" href="param__serializer_8cpp.html" title="Implementation of query_param serialization.">protocol/param_serializer.cpp</a></code>: query_param</li>
<li><code><a class="el" href="request__serializer_8cpp.html" title="Implementation of query_request serialization.">protocol/request_serializer.cpp</a></code>: query_request</li>
<li><code><a class="el" href="response__serializer_8cpp.html" title="Implementation of query_response, column_metadata, result_row serialization.">protocol/response_serializer.cpp</a></code>: query_response</li>
</ul>
</li>
</ul>
</li>
<li>[x] Implement TCP Listener<ul>
<li>[x] gateway_server: TCP server using kcenon::network::core::messaging_server</li>
<li>[x] Client session management with authentication support</li>
</ul>
</li>
<li>[x] Implement Query Routing &amp; Load Balancing<ul>
<li>[x] query_router: Routes queries to connection pool</li>
<li>[x] Priority-based scheduling integration</li>
<li>[x] Metrics collection for performance monitoring</li>
<li>[x] server_app integration with gateway and query router</li>
<li>[x] CRTP-based query handlers for zero virtual dispatch overhead (<a href="https://github.com/kcenon/database_server/issues/48">#48</a>)</li>
</ul>
</li>
<li>[x] Add authentication middleware (Phase 3.4)<ul>
<li>[x] auth_middleware: Token validation with pluggable validators</li>
<li>[x] rate_limiter: Sliding window rate limiting with burst support</li>
<li>[x] Audit logging for security events</li>
<li>[x] Integration with gateway_server request pipeline</li>
</ul>
</li>
<li>[x] Write integration tests and benchmarks (Phase 3.5)<ul>
<li>[x] Integration tests for complete query flow</li>
<li>[x] Error handling scenario tests</li>
<li>[x] Performance benchmarks (target: 10k+ queries/sec)</li>
<li>[x] Latency measurement (target: &lt; 1ms routing overhead)</li>
</ul>
</li>
<li>[x] Implement Query Result Cache (<a href="https://github.com/kcenon/database_server/issues/30">#30</a>)<ul>
<li>[x] LRU eviction policy with configurable max entries</li>
<li>[x] TTL-based expiration for cached results</li>
<li>[x] Automatic cache invalidation on write operations</li>
<li>[x] SQL table name extraction for targeted invalidation</li>
<li>[x] Thread-safe implementation with shared_mutex</li>
<li>[x] Comprehensive cache metrics</li>
</ul>
</li>
<li>[x] IExecutor Interface Integration (<a href="https://github.com/kcenon/database_server/issues/45">#45</a>)<ul>
<li>[x] Optional IExecutor injection for background tasks</li>
<li>[x] Resilience module: health monitoring via IExecutor</li>
<li>[x] Gateway module: async query execution via IExecutor</li>
<li>[x] Fallback to std::async when executor not provided</li>
<li>[x] Centralized executor management in server_app</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md39"></a>
Phase 4: Foundation System Improvements Integration (&lt;a href="https://github.com/kcenon/database_server/issues/50" &gt;#50&lt;/a&gt;)</h3>
<ul>
<li>[x] IExecutor Interface Integration (<a href="https://github.com/kcenon/database_server/issues/45">#45</a>)<ul>
<li>[x] Unified async execution in gateway, pooling, and resilience modules</li>
<li>[x] Optional IExecutor injection with std::async fallback</li>
</ul>
</li>
<li>[x] Result&lt;T&gt; Pattern Adoption (<a href="https://github.com/kcenon/database_server/issues/46">#46</a>)<ul>
<li>[x] Type-safe error handling in gateway query processing</li>
<li>[x] Consistent Result&lt;T&gt; returns across all protocol handlers</li>
<li>[x] Cache and router operations return Result&lt;T&gt;</li>
</ul>
</li>
<li>[x] C++20 Module Migration (<a href="https://github.com/kcenon/database_server/issues/47">#47</a>)<ul>
<li>[x] Primary module: <code>kcenon.database_server</code></li>
<li>[x] Partitions: <code>:core</code>, <code>:gateway</code>, <code>:pooling</code>, <code>:resilience</code>, <code>:metrics</code></li>
<li>[x] Clean dependency management with module imports</li>
</ul>
</li>
<li>[x] CRTP Pattern for Protocol Handlers (<a href="https://github.com/kcenon/database_server/issues/48">#48</a>)<ul>
<li>[x] Zero virtual dispatch overhead for query handling</li>
<li>[x] 7 CRTP handlers: select, insert, update, delete, execute, ping, batch</li>
<li>[x] Type erasure wrapper for runtime polymorphism</li>
</ul>
</li>
<li>[x] CRTP-Based Query Metrics Collector (<a href="https://github.com/kcenon/database_server/issues/49">#49</a>)<ul>
<li>[x] <code>query_collector_base</code> CRTP template</li>
<li>[x] Metrics: query execution, cache performance, pool utilization, sessions</li>
<li>[x] Integration with monitoring_system patterns</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md40"></a>
Planned Features</h2>
<p>The following features are planned for future releases:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Feature   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Status    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">QUIC Protocol   </td><td class="markdownTableBodyNone">High-performance UDP-based transport with built-in TLS   </td><td class="markdownTableBodyNone">Planned    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Query Result Cache   </td><td class="markdownTableBodyNone">In-memory cache for SELECT query results with TTL and LRU eviction   </td><td class="markdownTableBodyNone">âœ… Completed (<a href="https://github.com/kcenon/database_server/issues/30">#30</a>)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IExecutor Integration   </td><td class="markdownTableBodyNone">Unified async execution with common_system IExecutor interface   </td><td class="markdownTableBodyNone">âœ… Completed (<a href="https://github.com/kcenon/database_server/issues/45">#45</a>)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Result&lt;T&gt; Pattern   </td><td class="markdownTableBodyNone">Type-safe error handling with common_system Result&lt;T&gt;   </td><td class="markdownTableBodyNone">âœ… Completed (<a href="https://github.com/kcenon/database_server/issues/46">#46</a>)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">C++20 Modules   </td><td class="markdownTableBodyNone">Modular compilation with partitioned module structure   </td><td class="markdownTableBodyNone">âœ… Completed (<a href="https://github.com/kcenon/database_server/issues/47">#47</a>)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">CRTP Query Handlers   </td><td class="markdownTableBodyNone">Zero virtual dispatch overhead for query processing   </td><td class="markdownTableBodyNone">âœ… Completed (<a href="https://github.com/kcenon/database_server/issues/48">#48</a>)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CRTP Metrics Collector   </td><td class="markdownTableBodyNone">Zero-overhead query metrics collection following monitoring_system pattern   </td><td class="markdownTableBodyNone">âœ… Completed (<a href="https://github.com/kcenon/database_server/issues/49">#49</a>)   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md41"></a>
Executor Integration</h2>
<p>The server supports optional <code>IExecutor</code> injection from <code>common_system</code> for centralized thread management. This allows sharing a single thread pool across components for efficient resource utilization.</p>
<h3><a class="anchor" id="autotoc_md42"></a>
Usage Example</h3>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="server__app_8h.html">kcenon/database_server/server_app.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;kcenon/thread/adapters/common_executor_adapter.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;kcenon/thread/core/thread_pool.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create server app</span></div>
<div class="line"><a class="code hl_class" href="classdatabase__server_1_1server__app.html">database_server::server_app</a> app;</div>
<div class="line">app.<a class="code hl_function" href="classdatabase__server_1_1server__app.html#a2fe8890d558f5d67f8051709d22b8391">initialize</a>(<span class="stringliteral">&quot;config.conf&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create shared executor (optional)</span></div>
<div class="line"><span class="keyword">auto</span> pool = std::make_shared&lt;kcenon::thread::thread_pool&gt;(<span class="stringliteral">&quot;shared_executor&quot;</span>, 4);</div>
<div class="line">pool-&gt;start();</div>
<div class="line"><span class="keyword">auto</span> executor = kcenon::thread::adapters::common_executor_factory::create_from_thread_pool(pool);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Inject executor for unified thread management</span></div>
<div class="line">app.<a class="code hl_function" href="classdatabase__server_1_1server__app.html#a796984d19c3ae86822bc7c3887671c50">set_executor</a>(executor);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Start server - async queries and health monitoring will use shared executor</span></div>
<div class="line">app.<a class="code hl_function" href="classdatabase__server_1_1server__app.html#a5c81b07f8c97e8aed37f5725c782f4bf">run</a>();</div>
<div class="ttc" id="aclassdatabase__server_1_1server__app_html_a796984d19c3ae86822bc7c3887671c50"><div class="ttname"><a href="classdatabase__server_1_1server__app.html#a796984d19c3ae86822bc7c3887671c50">database_server::server_app::set_executor</a></div><div class="ttdeci">void set_executor(std::shared_ptr&lt; kcenon::common::interfaces::IExecutor &gt; executor)</div><div class="ttdoc">Set the executor for background tasks.</div><div class="ttdef"><b>Definition</b> <a href="server__app_8cpp_source.html#l00320">server_app.cpp:320</a></div></div>
<div class="ttc" id="aserver__app_8h_html"><div class="ttname"><a href="server__app_8h.html">server_app.h</a></div><div class="ttdoc">Database server application interface.</div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md43"></a>
Components with IExecutor Support</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Component   </th><th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>server_app</code>   </td><td class="markdownTableBodyNone"><code>set_executor()</code>   </td><td class="markdownTableBodyNone">Centralized executor management    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>query_router</code>   </td><td class="markdownTableBodyNone"><code>set_executor()</code>   </td><td class="markdownTableBodyNone">Async query execution    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>connection_health_monitor</code>   </td><td class="markdownTableBodyNone">Constructor   </td><td class="markdownTableBodyNone">Background health monitoring    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>resilient_database_connection</code>   </td><td class="markdownTableBodyNone">Constructor   </td><td class="markdownTableBodyNone">Propagates to health monitor   </td></tr>
</table>
<p>When no executor is provided, components automatically fall back to <code>std::async</code> for background tasks.</p>
<h2><a class="anchor" id="autotoc_md44"></a>
Metrics Collection</h2>
<p>The server includes a CRTP-based metrics collector for comprehensive performance monitoring, following the monitoring_system's collector pattern for zero-overhead collection.</p>
<h3><a class="anchor" id="autotoc_md45"></a>
Metrics Categories</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Category   </th><th class="markdownTableHeadNone">Metrics   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Query Execution   </td><td class="markdownTableBodyNone">total/success/failed/timeout, latency   </td><td class="markdownTableBodyNone">Query performance tracking    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Cache Performance   </td><td class="markdownTableBodyNone">hits/misses, hit ratio, evictions   </td><td class="markdownTableBodyNone">Cache efficiency monitoring    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Pool Utilization   </td><td class="markdownTableBodyNone">active/idle connections, acquisition time   </td><td class="markdownTableBodyNone">Connection pool health    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Session Management   </td><td class="markdownTableBodyNone">active sessions, auth events, duration   </td><td class="markdownTableBodyNone">Session lifecycle tracking   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md46"></a>
Usage Example</h3>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="query__metrics__collector_8h.html">kcenon/database_server/metrics/query_metrics_collector.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacedatabase__server_1_1metrics.html">database_server::metrics</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Get global collector</span></div>
<div class="line"><span class="keyword">auto</span>&amp; collector = get_query_metrics_collector();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Initialize with configuration</span></div>
<div class="line">collector.initialize({</div>
<div class="line">    {<span class="stringliteral">&quot;enabled&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;track_query_types&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>}</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Record query execution</span></div>
<div class="line"><a class="code hl_struct" href="structdatabase__server_1_1metrics_1_1query__execution.html">query_execution</a> exec;</div>
<div class="line">exec.<a class="code hl_variable" href="structdatabase__server_1_1metrics_1_1query__execution.html#ae1bb275d4d2c3b617c16f5cd7c795086">query_type</a> = <span class="stringliteral">&quot;select&quot;</span>;</div>
<div class="line">exec.<a class="code hl_variable" href="structdatabase__server_1_1metrics_1_1query__execution.html#a129dd1a8f2546ffcc2e79c0f392065dc">latency_ns</a> = 1500000;  <span class="comment">// 1.5ms</span></div>
<div class="line">exec.<a class="code hl_variable" href="structdatabase__server_1_1metrics_1_1query__execution.html#abd2bf1fd79ea7d51c58edf9fd7db9232">success</a> = <span class="keyword">true</span>;</div>
<div class="line">collector.collect_query_metrics(exec);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Record cache operation</span></div>
<div class="line"><a class="code hl_struct" href="structdatabase__server_1_1metrics_1_1cache__stats.html">cache_stats</a> cache;</div>
<div class="line">cache.<a class="code hl_variable" href="structdatabase__server_1_1metrics_1_1cache__stats.html#aa36b334e27b516b799b5d1566c333527">hit</a> = <span class="keyword">true</span>;</div>
<div class="line">collector.collect_cache_metrics(cache);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Get metrics for monitoring</span></div>
<div class="line"><span class="keyword">const</span> <span class="keyword">auto</span>&amp; metrics = collector.get_metrics();</div>
<div class="line"><span class="keywordtype">double</span> avg_latency = metrics.query_metrics.avg_query_latency_ms();</div>
<div class="line"><span class="keywordtype">double</span> cache_hit_ratio = metrics.cache_metrics.cache_hit_ratio();</div>
<div class="ttc" id="anamespacedatabase__server_1_1metrics_html"><div class="ttname"><a href="namespacedatabase__server_1_1metrics.html">database_server::metrics</a></div><div class="ttdef"><b>Definition</b> <a href="metrics__base_8h_source.html#l00073">metrics_base.h:74</a></div></div>
<div class="ttc" id="aquery__metrics__collector_8h_html"><div class="ttname"><a href="query__metrics__collector_8h.html">query_metrics_collector.h</a></div><div class="ttdoc">CRTP-based query metrics collector implementation.</div></div>
<div class="ttc" id="astructdatabase__server_1_1metrics_1_1cache__stats_html"><div class="ttname"><a href="structdatabase__server_1_1metrics_1_1cache__stats.html">database_server::metrics::cache_stats</a></div><div class="ttdoc">Cache statistics snapshot.</div><div class="ttdef"><b>Definition</b> <a href="query__collector__base_8h_source.html#l00126">query_collector_base.h:127</a></div></div>
<div class="ttc" id="astructdatabase__server_1_1metrics_1_1cache__stats_html_aa36b334e27b516b799b5d1566c333527"><div class="ttname"><a href="structdatabase__server_1_1metrics_1_1cache__stats.html#aa36b334e27b516b799b5d1566c333527">database_server::metrics::cache_stats::hit</a></div><div class="ttdeci">bool hit</div><div class="ttdoc">Whether operation was a hit.</div><div class="ttdef"><b>Definition</b> <a href="query__collector__base_8h_source.html#l00128">query_collector_base.h:128</a></div></div>
<div class="ttc" id="astructdatabase__server_1_1metrics_1_1query__execution_html"><div class="ttname"><a href="structdatabase__server_1_1metrics_1_1query__execution.html">database_server::metrics::query_execution</a></div><div class="ttdoc">Information about a single query execution.</div><div class="ttdef"><b>Definition</b> <a href="query__collector__base_8h_source.html#l00098">query_collector_base.h:99</a></div></div>
<div class="ttc" id="astructdatabase__server_1_1metrics_1_1query__execution_html_a129dd1a8f2546ffcc2e79c0f392065dc"><div class="ttname"><a href="structdatabase__server_1_1metrics_1_1query__execution.html#a129dd1a8f2546ffcc2e79c0f392065dc">database_server::metrics::query_execution::latency_ns</a></div><div class="ttdeci">uint64_t latency_ns</div><div class="ttdoc">Query latency in nanoseconds.</div><div class="ttdef"><b>Definition</b> <a href="query__collector__base_8h_source.html#l00101">query_collector_base.h:101</a></div></div>
<div class="ttc" id="astructdatabase__server_1_1metrics_1_1query__execution_html_abd2bf1fd79ea7d51c58edf9fd7db9232"><div class="ttname"><a href="structdatabase__server_1_1metrics_1_1query__execution.html#abd2bf1fd79ea7d51c58edf9fd7db9232">database_server::metrics::query_execution::success</a></div><div class="ttdeci">bool success</div><div class="ttdoc">Whether query succeeded.</div><div class="ttdef"><b>Definition</b> <a href="query__collector__base_8h_source.html#l00102">query_collector_base.h:102</a></div></div>
<div class="ttc" id="astructdatabase__server_1_1metrics_1_1query__execution_html_ae1bb275d4d2c3b617c16f5cd7c795086"><div class="ttname"><a href="structdatabase__server_1_1metrics_1_1query__execution.html#ae1bb275d4d2c3b617c16f5cd7c795086">database_server::metrics::query_execution::query_type</a></div><div class="ttdeci">std::string query_type</div><div class="ttdoc">Type of query (select, insert, etc.)</div><div class="ttdef"><b>Definition</b> <a href="query__collector__base_8h_source.html#l00100">query_collector_base.h:100</a></div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md47"></a>
Monitoring System Integration</h3>
<div class="fragment"><div class="line"><span class="comment">// Initialize monitoring integration</span></div>
<div class="line">initialize_monitoring_integration(<span class="stringliteral">&quot;my_database_server&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set export callback for custom monitoring systems</span></div>
<div class="line">set_metrics_export_callback([](<span class="keyword">const</span> std::vector&lt;monitoring_metric&gt;&amp; metrics) {</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; m : metrics) {</div>
<div class="line">        <span class="comment">// Export to your monitoring system</span></div>
<div class="line">        push_to_prometheus(m.name, m.value, m.tags);</div>
<div class="line">    }</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Export current metrics</span></div>
<div class="line"><a class="code hl_function" href="namespacedatabase__server_1_1metrics.html#ad09c2c37f39a031e385da9dd0a052f64">export_metrics_to_monitoring</a>();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Get metrics for health endpoint</span></div>
<div class="line"><span class="keyword">auto</span> health_metrics = <a class="code hl_function" href="namespacedatabase__server_1_1metrics.html#a114aba5965c09b0ad480a15044fb377b">get_metrics_for_health_endpoint</a>();</div>
<div class="ttc" id="anamespacedatabase__server_1_1metrics_html_a114aba5965c09b0ad480a15044fb377b"><div class="ttname"><a href="namespacedatabase__server_1_1metrics.html#a114aba5965c09b0ad480a15044fb377b">database_server::metrics::get_metrics_for_health_endpoint</a></div><div class="ttdeci">std::unordered_map&lt; std::string, double &gt; get_metrics_for_health_endpoint()</div><div class="ttdoc">Get all metrics as a map for health endpoint.</div><div class="ttdef"><b>Definition</b> <a href="collector__integration_8cpp_source.html#l00316">collector_integration.cpp:316</a></div></div>
<div class="ttc" id="anamespacedatabase__server_1_1metrics_html_ad09c2c37f39a031e385da9dd0a052f64"><div class="ttname"><a href="namespacedatabase__server_1_1metrics.html#ad09c2c37f39a031e385da9dd0a052f64">database_server::metrics::export_metrics_to_monitoring</a></div><div class="ttdeci">void export_metrics_to_monitoring()</div><div class="ttdoc">Export current metrics to monitoring system.</div><div class="ttdef"><b>Definition</b> <a href="collector__integration_8cpp_source.html#l00120">collector_integration.cpp:120</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md48"></a>
Security</h2>
<h3><a class="anchor" id="autotoc_md49"></a>
Session ID Generation</h3>
<p>Session IDs are generated using cryptographically secure methods:</p>
<ul>
<li><b>128-bit entropy</b>: Uses two 64-bit random values for unpredictability</li>
<li><b>Hardware seeding</b>: Uses <code>std::random_device</code> for hardware entropy</li>
<li><b>Thread-safe</b>: Thread-local RNG prevents contention and predictability</li>
<li><b>Format</b>: 32-character lowercase hexadecimal string</li>
</ul>
<p>The session ID format changed from predictable timestamp-counter pattern to secure random values. Old format (<code>session_TIMESTAMP_COUNTER</code>) was vulnerable to session hijacking through ID prediction.</p>
<h3><a class="anchor" id="autotoc_md50"></a>
Security Best Practices</h3>
<ol type="1">
<li><b>Authentication</b>: Enable <code>auth.enabled=true</code> in production</li>
<li><b>Rate Limiting</b>: Configure appropriate rate limits to prevent abuse</li>
<li><b>TLS</b>: Enable TLS for encrypted connections (<code>network.enable_tls=true</code>)</li>
<li><b>Logging</b>: Avoid logging full session IDs in production environments</li>
</ol>
<h2><a class="anchor" id="autotoc_md51"></a>
License</h2>
<p>BSD 3-Clause License - see [LICENSE](LICENSE) for details.</p>
<h2><a class="anchor" id="autotoc_md52"></a>
CI/CD</h2>
<p>The project includes comprehensive CI/CD workflows matching the database_system pipeline:</p>
<h3><a class="anchor" id="autotoc_md53"></a>
Core Workflows</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Workflow   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Status    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>ci.yml</code>   </td><td class="markdownTableBodyNone">Multi-platform build (Ubuntu, macOS, Windows)   </td><td class="markdownTableBodyNone">Active    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>integration-tests.yml</code>   </td><td class="markdownTableBodyNone">Integration tests with coverage   </td><td class="markdownTableBodyNone">Active    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>coverage.yml</code>   </td><td class="markdownTableBodyNone">Code coverage with Codecov   </td><td class="markdownTableBodyNone">Active   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md54"></a>
Quality Gates</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Workflow   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Status    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>static-analysis.yml</code>   </td><td class="markdownTableBodyNone">clang-tidy and cppcheck analysis   </td><td class="markdownTableBodyNone">Active    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>sanitizers.yml</code>   </td><td class="markdownTableBodyNone">ASan, TSan, UBSan checks   </td><td class="markdownTableBodyNone">Active   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md55"></a>
Security &amp; Documentation</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Workflow   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Status    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>dependency-security-scan.yml</code>   </td><td class="markdownTableBodyNone">Trivy vulnerability scanning   </td><td class="markdownTableBodyNone">Active    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>sbom.yml</code>   </td><td class="markdownTableBodyNone">SBOM generation (CycloneDX, SPDX)   </td><td class="markdownTableBodyNone">Active    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>build-Doxygen.yaml</code>   </td><td class="markdownTableBodyNone">API documentation generation   </td><td class="markdownTableBodyNone">Active   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md56"></a>
Performance</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Workflow   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Status    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>benchmarks.yml</code>   </td><td class="markdownTableBodyNone">Performance regression testing   </td><td class="markdownTableBodyNone">Active   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md57"></a>
Related Projects</h2>
<ul>
<li><a href="../common_system">common_system</a> - Core utilities and interfaces</li>
<li><a href="../thread_system">thread_system</a> - Threading and job scheduling</li>
<li><a href="../network_system">network_system</a> - Network communication</li>
<li><a href="../database_system">database_system</a> - Database client library </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun Feb 22 2026 18:17:38 for Database Server by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
